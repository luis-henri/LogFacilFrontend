import{d as W,r as o,z as j,A as N,B as K,O as Q,c as i,i as v,a as e,m as U,t as u,f as k,b as _,v as y,J as X,F as V,x as M,p as Y,o as n,n as Z,h as ee}from"./index-ca90286d.js";import{H as ae}from"./Header-d700b98c.js";import{V as te}from"./VisualizarItensPopup-8055c543.js";import{N as se}from"./NotificationPopUp-aebb2319.js";import{r as oe,a as ie}from"./UserCircleIcon-fd25655d.js";import{_ as ne}from"./_plugin-vue_export-helper-c27b6911.js";const le={class:"container"},re={class:"grow p-4 sm:p-6 lg:p-8"},ue={class:"page-container"},ce={class:"header-container"},de={class:"header-left"},me={class:"user-info-wrapper"},pe={class:"user-name"},ve={key:0,class:"dropdown-menu"},fe={class:"filters-container"},_e={class:"filter-item"},ge={class:"filter-item"},be={class:"filter-item"},he={class:"filter-item"},Ce=["value"],ke={class:"table-scroll-container"},ye={key:0,class:"loading-message"},we={key:1,class:"responsive-table"},Se={key:0},qe={key:0},Ne={"data-label":"Data/Hora"},Ue={"data-label":"UR"},Ve={"data-label":"Número"},Me={"data-label":"Situação"},Re={"data-label":"Ações"},xe={class:"acoes-cell"},De={class:"tooltip-container","data-tooltip":"Visualizar Itens"},ze={"data-label":"Observação"},Ie=W({__name:"MonitoramentoView",setup(Fe){const l=Y(),g=o([]),f=o(!0),b=o("Usuário"),h=o(!1),C=o(!1),w=o(null);function R(){c.value="",d.value="",m.value="",p.value=""}const c=o(""),d=o(""),m=o(""),p=o(""),r=j({visible:!1,title:"",message:""});function x(s,a){r.title=s,r.message=a,r.visible=!0}function D(){r.visible=!1}const S=N(()=>g.value.filter(s=>{const a=!c.value||s.data_requisicao.startsWith(c.value),t=!d.value||s.requisitante_requisicao.toLowerCase().includes(d.value.toLowerCase()),q=!m.value||s.numero_requisicao.toString().includes(m.value),T=!p.value||s.situacao.descricao_situacao_requisicao===p.value;return a&&t&&q&&T})),z=N(()=>{const s=g.value.map(a=>a.situacao.descricao_situacao_requisicao);return[...new Set(s)]});K(async()=>{const s=localStorage.getItem("user-token");if(s)try{const a=JSON.parse(atob(s.split(".")[1]));b.value=a.nome||"Usuário"}catch{b.value="Usuário"}await I()});async function I(){f.value=!0;try{g.value=await Q()}catch(s){x("Erro",`Erro ao buscar dados de monitoramento: ${s.message}`)}finally{f.value=!1}}function F(s){w.value=s,C.value=!0}function L(){C.value=!1}function E(){h.value=!h.value}function B(){localStorage.removeItem("user-token"),l.push({name:"Login"})}function O(){l.push({name:"GerenciamentoUsuarios"})}function P(){l.push({name:"Requisicao"})}function H(){l.push({name:"Separacao"})}function A(){l.push({name:"Conferencia"})}function $(){l.push({name:"Embalagem"})}function G(){l.push({name:"Remessa"})}function J(s){if(!s)return"status-pendente";const a=s.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"-");return{pendente:"status-pendente","em-atendimento":"status-em-atendimento","em-separacao":"status-em-separacao","enviado-para-separacao":"status-enviado-para-separacao","em-conferencia":"status-em-conferencia","enviado-para-conferencia":"status-enviado-para-conferencia","em-embalagem":"status-em-embalagem","enviado-para-embalagem":"status-enviado-para-embalagem","em-expedicao":"status-em-expedicao","enviado-para-expedicao":"status-enviado-para-expedicao",concluida:"status-concluida",cancelada:"status-cancelada"}[a]||"status-pendente"}return(s,a)=>(n(),i("div",le,[v(ae),e("main",re,[e("div",ue,[e("div",ce,[e("div",de,[e("div",me,[e("div",{class:"user-info",onClick:E},[v(U(oe),{class:"user-icon"}),e("span",pe,u(b.value),1)]),h.value?(n(),i("div",ve,[e("button",{onClick:O,class:"gouser-item"},"Gerenciar Usuários"),e("button",{onClick:P,class:"gouser-item"},"Requisição"),e("button",{onClick:H,class:"gouser-item"},"Separação"),e("button",{onClick:A,class:"gouser-item"},"Conferência"),e("button",{onClick:$,class:"gouser-item"},"Embalagem"),e("button",{onClick:G,class:"gouser-item"},"Conferência/Remessa"),e("button",{onClick:B,class:"dropdown-item"},"Sair")])):k("",!0)]),a[4]||(a[4]=e("h2",{class:"container-title"},"Monitoramento de Requisições",-1))])]),e("div",fe,[e("div",_e,[a[5]||(a[5]=e("label",{for:"data"},"Data",-1)),_(e("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>c.value=t),type:"date",id:"data",class:"filter-input"},null,512),[[y,c.value]])]),e("div",ge,[a[6]||(a[6]=e("label",{for:"ur"},"UR",-1)),_(e("input",{"onUpdate:modelValue":a[1]||(a[1]=t=>d.value=t),type:"text",id:"ur",placeholder:"Filtrar por UR",class:"filter-input"},null,512),[[y,d.value]])]),e("div",be,[a[7]||(a[7]=e("label",{for:"numero"},"Número da Requisição",-1)),_(e("input",{"onUpdate:modelValue":a[2]||(a[2]=t=>m.value=t),type:"text",id:"numero",placeholder:"Filtrar por Número",class:"filter-input"},null,512),[[y,m.value]])]),e("div",he,[a[9]||(a[9]=e("label",{for:"situacao"},"Situação",-1)),_(e("select",{"onUpdate:modelValue":a[3]||(a[3]=t=>p.value=t),id:"situacao",class:"filter-select"},[a[8]||(a[8]=e("option",{value:""},"Todas",-1)),(n(!0),i(V,null,M(z.value,t=>(n(),i("option",{key:t,value:t},u(t),9,Ce))),128))],512),[[X,p.value]])]),e("div",{class:"filter-item"},[e("button",{onClick:R,class:"button-clear-filters"},"Limpar Filtros")])]),e("div",ke,[f.value?(n(),i("div",ye,"Carregando requisições...")):(n(),i("table",we,[a[11]||(a[11]=e("thead",null,[e("tr",null,[e("th",null,"Data/Hora"),e("th",null,"UR"),e("th",null,"Número"),e("th",null,"Situação"),e("th",null,"Ações"),e("th",null,"Observação")])],-1)),f.value?k("",!0):(n(),i("tbody",Se,[S.value.length===0?(n(),i("tr",qe,a[10]||(a[10]=[e("td",{colspan:"6",class:"no-data-message"},"Nenhuma requisição encontrada com os filtros aplicados.",-1)]))):k("",!0),(n(!0),i(V,null,M(S.value,t=>(n(),i("tr",{key:t.id_requisicao,class:"hover:bg-gray-50"},[e("td",Ne,u(new Date(t.data_requisicao).toLocaleString("pt-BR")),1),e("td",Ue,u(t.requisitante_requisicao),1),e("td",Ve,u(t.numero_requisicao),1),e("td",Me,[e("span",{class:Z(["status-badge",J(t.situacao.descricao_situacao_requisicao)])},u(t.situacao.descricao_situacao_requisicao),3)]),e("td",Re,[e("div",xe,[e("div",De,[v(U(ie),{onClick:ee(q=>F(t),["stop"]),class:"icon-acao",title:"Visualizar Itens"},null,8,["onClick"])])])]),e("td",ze,u(t.observacao_requisicao||"-"),1)]))),128))]))]))])])]),v(te,{visible:C.value,requisicao:w.value,onClose:L},null,8,["visible","requisicao"]),v(se,{visible:r.visible,title:r.title,message:r.message,onClose:D},null,8,["visible","title","message"])]))}});const Ae=ne(Ie,[["__scopeId","data-v-fe490df1"]]);export{Ae as default};
