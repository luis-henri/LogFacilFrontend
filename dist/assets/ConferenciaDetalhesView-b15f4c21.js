import{d as V,r as m,z as b,B as x,P as k,c as n,i as p,a as e,q as c,t as r,n as P,F as A,x as B,f as g,Q as D,p as R,E as C,o as l,b as z,v as I}from"./index-ca90286d.js";import{H as M}from"./Header-d700b98c.js";import{N as S}from"./NotificationPopUp-aebb2319.js";import{A as U}from"./AcaoConcluidaPopup-497e7117.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";import"./logosvg-29db6bb5.js";const T={class:"container"},F={class:"grow p-4 sm:p-6 lg:p-8"},H={class:"page-container"},L={key:0,class:"content-wrapper"},O={class:"details-section"},j={class:"table-container"},G={class:"responsive-table"},J={"data-label":"Material"},K={"data-label":"Qtd. Conferida"},W=["onUpdate:modelValue"],X={key:1,class:"loading-message"},Y={class:"footer-actions"},Z=["disabled"],$=V({__name:"ConferenciaDetalhesView",setup(ee){const y=D(),v=R(),i=m(null),_=m(!0),u=m(!1),t=b({visible:!1,title:"",message:""});function f(o,a){t.title=o,t.message=a,t.visible=!0}function h(){t.visible=!1}const s=b({visible:!1,title:"",message:""});x(async()=>{const o=y.params.id;try{i.value=await k(o),i.value&&i.value.itens.forEach(a=>{a.quantidade_atendida_item_requisicao=null})}catch(a){console.error("Erro ao buscar dados da requisição para conferência:",a),f("Erro","Não foi possível carregar os dados da requisição.")}finally{_.value=!1}});async function N(){if(i.value){u.value=!0;try{const o={status:"enviado-para-embalagem",itens:i.value.itens.map(a=>({id_item_requisicao:a.id_item_requisicao,quantidade_atendida_item_requisicao:a.quantidade_atendida_item_requisicao||0}))};await C(i.value.id_requisicao,o),s.title="Conferência Efetivada!",s.message="A requisição foi enviada com sucesso para a próxima etapa de embalagem.",s.visible=!0}catch(o){console.error("Erro ao efetivar conferência:",o),f("Erro","Não foi possível efetivar a conferência.")}finally{u.value=!1}}}async function E(){if(!i.value){v.push({name:"Conferencia"});return}try{await C(i.value.id_requisicao,{status:"enviado-para-conferencia-separacao"}),v.push({name:"Conferencia"})}catch(o){console.error("Erro ao voltar e reverter status:",o),f("Erro","Ocorreu um erro ao tentar voltar."),v.push({name:"Conferencia"})}}return(o,a)=>{var q;return l(),n("div",T,[p(M,{title:"Requisição - Conferência"}),e("main",F,[e("div",H,[a[7]||(a[7]=e("div",{class:"header-container"},[e("h2",{class:"container-title"},"Conferência - Separação")],-1)),!_.value&&i.value?(l(),n("div",L,[e("div",O,[e("div",null,[a[0]||(a[0]=e("strong",null,"Número:",-1)),c(" "+r(i.value.numero_requisicao),1)]),e("div",null,[a[1]||(a[1]=e("strong",null,"Unidade:",-1)),c(" "+r(i.value.requisitante_requisicao),1)]),e("div",null,[a[2]||(a[2]=e("strong",null,"Prioridade:",-1)),a[3]||(a[3]=c()),e("span",{class:P({"text-yellow-600 font-bold":i.value.prioridade_requisicao})},r(i.value.prioridade_requisicao?"Sim":"Não"),3)]),e("div",null,[a[4]||(a[4]=e("strong",null,"Tipo de Envio:",-1)),c(" "+r(((q=i.value.tipo_envio)==null?void 0:q.descricao_tipo_envio_requisicao)||"Não definido"),1)])]),a[6]||(a[6]=e("h3",{class:"items-title"},"Itens para Conferência",-1)),e("div",j,[e("table",G,[a[5]||(a[5]=e("thead",null,[e("tr",null,[e("th",null,"Material"),e("th",null,"Qtd. Conferida")])],-1)),e("tbody",null,[(l(!0),n(A,null,B(i.value.itens,d=>(l(),n("tr",{key:d.id_item_requisicao},[e("td",J,r(d.descricao_material_item_requisicao),1),e("td",K,[z(e("input",{type:"number",class:"input-qty",min:"0","onUpdate:modelValue":w=>d.quantidade_atendida_item_requisicao=w,placeholder:"0"},null,8,W),[[I,d.quantidade_atendida_item_requisicao,void 0,{number:!0}]])])]))),128))])])])])):g("",!0),_.value?(l(),n("div",X,"Carregando detalhes da conferência...")):g("",!0),e("footer",Y,[e("button",{onClick:E,class:"button-secondary"},"Voltar"),e("button",{onClick:N,class:"button-primary",disabled:u.value},r(u.value?"Aguarde...":"Efetivar Conferência"),9,Z)])])]),p(S,{visible:t.visible,title:t.title,message:t.message,onClose:h},null,8,["visible","title","message"]),p(U,{visible:s.visible,title:s.title,message:s.message},null,8,["visible","title","message"])])}}});const ne=Q($,[["__scopeId","data-v-c9730110"]]);export{ne as default};
